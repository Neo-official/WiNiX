"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[944],{944:(e,t,o)=>{o.r(t),o.d(t,{CustomMap:()=>S,MapEditor:()=>I});var n=o(5155),a=o(984),l=o(2115);o(8413),o(3919),o(9149);var r=o(9184),s=o(3312),i=o(8741),c=o(6756),d=o(3710),p=o(3314),u=o(3195),m=o(6694),x=o(8610),h=o(652),g=o(8694),j=o(8419);o(5167),o(9487);let b=e=>(0,i.divIcon)({html:'<div class="bg-primary-500 w-8 h-8">'.concat(r.Pt[e.status],"</div>"),className:e.status===a.dI.BROKEN?r.Tj[e.status]:r.Tj[e.area in r.Tj?e.area:"default"],iconSize:(0,i.point)(40,40,!0),iconAnchor:(0,i.point)(20,20,!0)});function f(e){let{}=e,t=r.Jb,o=(0,c.ko)(),[a,i]=(0,l.useState)(o.getCenter()),{lat:d,lng:p}=a,u="".concat(d.toFixed(4),", ").concat(p.toFixed(5));return(0,c.Po)({move(e){i(e.target.getCenter())},zoom(e){i(e.target.getCenter())}}),(0,n.jsxs)(s.$,{variant:"ghost",color:"transparent",className:"absolute left-2 bottom-2 z-[1] bg-white text-black rounded px-2 py-1 border-2 border-neutral-400",onClick:()=>o.flyTo(t,r.Pf),children:[(0,n.jsx)(m.A,{}),u]})}let v=e=>{let{coordinates:t}=e,o=e=>{try{let[t,o]=e.split(",").map(e=>e.trim());return{geo:"geo:".concat(t,",").concat(o,"?q=").concat(t,",").concat(o),apple:"maps://maps.apple.com/?ll=".concat(t,",").concat(o,"&q=").concat(t,",").concat(o),google:"https://www.google.com/maps?q=".concat(t,",").concat(o)}}catch(e){return null}};return(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"font-bold",children:"Coordinates:"}),(0,n.jsx)(s.$,{onClick:e=>{e.preventDefault();let n=o(t);n&&(window.location.href=n.geo,setTimeout(()=>{-1!==navigator.platform.indexOf("iPhone")||-1!==navigator.platform.indexOf("iPad")||-1!==navigator.platform.indexOf("iPod")?window.location.href=n.apple:window.open(n.google,"_blank")},500))},variant:"link",title:"Open in Maps",children:"Open in Maps"})]})};function w(e){let{device:t,onCoordinateSelect:o}=e,l=(0,c.ko)(),[i,m]=t.coordinates.split(",").map(e=>parseFloat(e.trim())),x=[i||r.Jb[0],m||r.Jb[1]];return(0,n.jsxs)(d.p,{icon:b(t),position:x,children:[(0,n.jsxs)(p.z,{children:[(0,n.jsxs)(s.$,{variant:"link",onClick:()=>o(t),className:"m-0 p-0",children:["#",t.id," - ",t.name]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(v,{coordinates:t.coordinates}),(0,n.jsxs)("div",{className:"flex item-center",children:[(0,n.jsx)("span",{className:"font-bold me-2",children:"Status:"}),(0,n.jsx)(j.J,{value:t.status,onChange:e=>{o({...t,status:e},!0)},source:a.dI})]})]}),(0,n.jsx)(s.$,{variant:"link",onClick:()=>l.setView(x,18),className:"m-0 p-0",children:"Zoom in"})]}),(0,n.jsx)(u.m,{sticky:!0,children:(0,n.jsxs)("span",{className:"text-lg font-bold",children:["#",t.id," - ",t.name]})})]},t.id)}function k(){let[e,t]=(0,l.useState)(null),o=(0,c.Po)({locationfound(e){t(e.latlng),o.flyTo(e.latlng,o.getZoom())}});return(0,l.useEffect)(()=>{let e=0;return navigator.geolocation?e=navigator.geolocation.watchPosition(function(e){t(new i.LatLng(e.coords.latitude,e.coords.longitude))},e=>console.error(e.code,e.message),{enableHighAccuracy:!0,timeout:6e4,maximumAge:6e5}):console.log("Geolocation is not supported by this browser."),()=>{navigator.geolocation.clearWatch(e)}},[]),(0,n.jsxs)(n.Fragment,{children:[null===e?null:(0,n.jsx)(d.p,{position:e,children:(0,n.jsx)(p.z,{children:"You are here"})}),(0,n.jsx)(s.$,{variant:"link",className:"absolute right-2 bottom-2 z-[1] bg-white text-black rounded px-2 py-1 border-2 border-neutral-400",onClick:()=>{o.locate()},children:(0,n.jsx)(x.A,{})})]})}function N(){let e=(0,c.ko)(),[t,o]=(0,l.useState)(!1);return(0,n.jsx)(s.$,{variant:"link",className:"absolute left-2 bottom-12 z-[1] bg-white text-black rounded px-2 py-1 border-2 border-neutral-400",onClick:()=>{if(document.fullscreenElement)document.exitFullscreen&&(document.exitFullscreen().then(()=>{e.invalidateSize()}),o(!1));else{let t=e.getContainer();t.requestFullscreen&&(t.requestFullscreen().then(()=>{e.invalidateSize()}),o(!0))}},children:t?(0,n.jsx)(h.A,{}):(0,n.jsx)(g.A,{})})}var C=o(833),y=o(933),z=o(6856),O=o(5256);let S=e=>{let{data:t,onCoordinateSelect:o,setMap:l}=e,s=Object.values(a.dI),i={[a.dI.PENDING]:!0,[a.dI.DONE]:!1,[a.dI.BROKEN]:!0},[c,d]=r.Jb.join(",").split(",").map(e=>parseFloat(e.trim())),p=[c||r.Jb[0],d||r.Jb[1]];return(0,n.jsxs)(C.W,{center:p,zoom:r.Pf,maxZoom:18,className:"h-[320px] w-full relative",ref:l,children:[(0,n.jsx)(y.e,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),(0,n.jsx)(f,{data:t}),(0,n.jsx)(k,{}),(0,n.jsx)(N,{}),(0,n.jsx)(z.In,{position:"topright",children:s.map(e=>(0,n.jsx)(z.In.Overlay,{checked:i[e],name:'Show "'.concat(e,'" Devices'),children:(0,n.jsx)(O.x,{children:t.filter(t=>t.status===e).map(e=>(0,n.jsx)(w,{device:e,onCoordinateSelect:o},e.id))})},e))})]})},I=e=>{let{editingItem:t,setEditingItem:o}=e,[a,l]=t.coordinates.split(",").map(e=>parseFloat(e.trim())),s=[a||r.Jb[0],l||r.Jb[1]],i=!!t;return(0,n.jsxs)(C.W,{center:s,zoom:13,style:{height:"400px",width:"100%",zIndex:0},children:[(0,n.jsx)(y.e,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),(0,n.jsx)(f,{data:[t]}),i&&(0,n.jsx)(e=>{let{onCoordinateSelect:t}=e;return(0,c.Po)({click(e){let{lat:o,lng:n}=e.latlng;t("".concat(o,",").concat(n))}}),null},{onCoordinateSelect:e=>o({...t,coordinates:e})}),t.coordinates&&(0,n.jsx)(d.p,{position:s,icon:b(t)})]})}}}]);